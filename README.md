# DomRobin扩展mod

## 目录
[基本介绍](#基本介绍) | [不正经的补充](#不正经的补充) | [致谢](#致谢) | [目前进度](#目前进度)  | [未实现的功能构想](#未实现的功能构想) 

## 基本介绍

开头预警：本mod是dol游戏的罗宾扩展mod，制作方向是成就一个独立的，高自信的，甚至可以保护pc的罗宾，mod目前只是半成品，只有部分功能的雏形，且十分简陋！所以readme也写得很随意...

mod现有文本和构想可下载"罗宾mod文本和构想整理.txt"直接查看（此文档每次提交同步更新，剧透预警），现有代码可直接在"game"文件夹下查看，在[百度贴吧](https://tieba.baidu.com/p/9001189698?pid=150209870173&cid=0#150209870173) 中也会更新制作过程。（贴吧账号：零环零理想）

本mod基于0.5.0.5版本进行自测，更老的版本可能会有不兼容的问题，如果您目前的游戏版本为0.4.7.5，请下载release下0.0.2-alpha中的domRobin.mod.zip（0.0.2-alpha版本的具体内容为[目前进度](#目前进度) 中的1-14）

**温馨提示：如果您使用0.5.0.5加载本模组报错的话，请更新汉化包！问题已经被大佬紧急修复。**

安装方式：下载release下0.0.3-temp中的domRobin.mod.zip，用平时玩游戏用的mod管理器加载完汉化mod后，再加载此mod，安装前记得保存自己的存档码，以防止出现bug无法恢复。

**请忽略release显示的上传时间，domRobin.mod.zip是会随readme同步更新的！**

## 不正经的补充

按理说这种未完成的mod不应该公开，但作者比较浮躁，做了一点点功能就急着分享...总之见谅！

作者是新手，代码和文笔甚至思维都很糟糕的那种，如果各位不嫌弃的话请提供bug测试以及文本/功能上的建议（意见），甚至（需要捏着鼻子看的）code review
（完了我感觉我完全是来白嫖的，赶紧划掉这句）

bug反馈群群号：964015275

## 致谢

- 感谢 Robin's GF （第二作者）对mod的具体设定的构想，文本创作以及观星约会图标创作，目前的构想是我们俩共同讨论出的结果。

- 感谢 [脸木挤白/苯环](https://github.com/Nephthelana) 在mod编写之初提供的代码修改！这是本mod得以起步的基础。

- 感谢群友"蜜雪冰城分店"为观星创作的两种精美图标。（暂未实装）

- 感谢贴吧吧友"电珠皮神"在mod编写前提供的部分文本。

- 感谢各位d级人员的试玩和bug反馈：（暂时列贴吧ID）无敌可爱乐园，kid1412870，空灵cream，该昵称未存在。

- 感谢[Miyazawa](https://github.com/miyakoAki4828)对本模组的持续关注以及对游戏图片格式的说明。

- 感谢 [脸木挤白/苯环](https://github.com/Nephthelana)，[隨風飄逸](https://github.com/chris81605)，[鲤鱼旗](https://github.com/koooooiCarp) 在模组开发群内的答疑和讨论。

- 感谢[Lyoko-Jeremie](https://github.com/Lyoko-Jeremie)大神开发了Modloader以及所有预置模组、[Number_Sir](https://github.com/NumberSir)大佬开发了模组编写助手，以及两位魔法师在模组开发群里提供的教程和指导。

- 感谢[Number_Sir](https://github.com/NumberSir)，[闰人](https://github.com/omvjro)，[丧心病](https://github.com/MissedHeart) 翻译了dol代码编写通用注意事项。

- 感谢原游戏作者，贡献者，汉化组全体成员以及所有为游戏社区做过贡献的玩家们。（ps: 感觉开始从盘古开天辟地感谢起了...）

## 目前进度

（ps: 会持续更新，以下功能只做过基本的自测，且文本未经打磨，非最终版本）：

1. 柠檬水摊升级功能雏形（文本已更新），知道罗宾的债务问题后去柠檬水摊开启选项，升级成功后可实现每周存款增加，「买柠檬水」和「提供帮助」时增加防雨和防晒功能，且可使用当前拥有的水果尝试榨汁，成功后下周饮料单上会增加新饮料。

2. 热巧克力摊改造/升级功能（升级过柠檬水摊时选项展示为「改造」), 改造/升级成功后可实现每周存款增加，「买热巧克力」和「提供帮助」时增加防雨和防雪功能，且保留榨汁机和购买新饮料（热饮）功能。

（备注：柠檬水摊/热巧克力摊升级后，可以触发下列新增商品）
* 和罗宾触发去电影院买爆米花，可以建议罗宾售卖爆米花，注意此功能与让气球摊摊主帮助罗宾互斥。
* 孤儿院阁楼解锁厨房后，可触发高自信罗宾主动售卖小点心。
* 让罗宾帮忙浇花且pc手上的鲜花超过两种后，可以建议罗宾帮忙卖花，每周都会根据罗宾的自信随机消耗拥有的鲜花并与罗宾平分卖花的收益。（某两种花除外）
* 气球摊摊主出场后，可以建议罗宾售卖气球，注意此功能与让气球摊摊主帮助罗宾互斥。

3. 去柠檬水摊时pc身上如果带有柠檬/血柠/野蜂巢，可以直接送给罗宾带来当周的存款增长，不需要前置条件。送野蜂巢后，当周「买柠檬水」选项会改为「买蜂蜜柠檬水」，且有文本细节变化。
  
4. 为罗宾推荐家教工作雏形，知道罗宾的债务问题后，pc去多瑙河街做家教时开启选项，需要随机到等级A以上的学科才能推荐成功，推荐成功后可以去找罗宾沟通，之后罗宾每天上学日15:06到16:20将位于多瑙河街，想放学后一起回家/触发校门口事件的pc要抓紧时间！
   
5. 修改了罗宾债务的计算逻辑为和pc一样每周递增，一旦罗宾无力支付就会触发惩罚（原游戏逻辑是每周加进度，不是直接计算的金额），新开局无任何额外干预的情况下，原设定的罗宾28天后卖游戏机，35天后被卖码头可以正常触发。

6. 修改了原作「拥抱」后「哭泣」无法触发创伤察觉的bug，为承担债务后「要钱」的文本增加高自信差分

7. 新增特质「同舟共济—罗宾」，罗宾固定周收入达到2000时周日会有提示，收到提示去罗宾的房间拿特质，效果为pc每日压力创伤减少，罗宾自信永远不会低于50（作弊也不行）
* 注意：此时pc不再承担罗宾的债务，所有以此为前提的剧情（包括告白信）都将无法触发，已经成为恋人的话没有影响，之后会慢慢补上新版告白信（已实装）
* 注意2：新增特质的版本装上后会偷偷计算pc为罗宾承担的债务总数，之后会有还钱剧情的（已实装）
* 注意3：新增成就——同舟共济，如果已经拿到过该特质，请使用魔法（不要问我为什么不写一个自动更新，逃）：
<<link [[手动获取同舟共济成就|$passage]]>><<earnFeat "In the Same Boat">><</link>>

8. 新工作—直播的雏形，知晓罗宾的债务问题后，「看罗宾玩游戏」时有20%概率触发灵感，需要罗宾或pc存款足够才会展示提议选项，成功后罗宾每周存款递增且会随机收到打赏，且每天晚上七点到八点将处于直播状态(时间有调整），诡术判定成功后可以偷看罗宾的直播内容。

9. 新工作—摄影的雏形，罗宾自信达标后，与罗宾野餐时可触发选项，可自己按提示准备服装也可穿罗宾（随机）赠送的服装，摄影收益会根据pc当周是否参与摄影/某两项属性是否达标而变化，pc参与摄影时会与罗宾平分收益。
* 注意：为配合5.0版本罗宾的学习时间，摄影时间由下午五点修改为下午六点，早上时间不变

10. 新特质——被罗宾守护，罗宾每周固定收入达标后出现提示，之后可通过租金战斗失败/拥抱时倾诉创伤两种方式触发特质和对应成就，该特质详细效果如下：
   
* pc每日压力减少2000（上限的五分之一，平时减压12/24那些都是乘以系数80的，所以没有特别夸张），
创伤根据自控减少75到112点（与另两种特质完全一致），罗宾每日创伤额外减一
* 所有（-/--/---罗宾的自信）界面文字描述消失（实际功能当然也会消失）
* 日志中原本的收租提醒改为"你已无需支付贝利的房租。" 不会再触发收租事件。
* 罗宾每周需要支付的债务翻倍，为简化逻辑，根据罗宾当前的债务而不是pc的来算，且忽略孩子数量
（反正pc承担债务以后也是按自己要交的钱来翻倍的，所以别在意细节！）
* 各种未交租事件不会再触发，不用担心贝利帮雷米袭击农场/不能进育儿室/夜袭等问题。

11. 额外小剧情：交租战斗失败后，未达到被守护条件，但罗宾存款够付当周房租时，pc可以免受当周惩罚

12. 「同舟共济」或「被罗宾守护」特质共同后续：
* 罗宾会向承担过债务的pc还钱
* 罗宾可以买回自己曾经卖掉的游戏机
* 罗宾会替其他孤儿付一周钱，并收到受助者的回报（两者触发概率均为所有孤儿院大厅随机事件的3%)
* 两种不同的新告白信和接受告白场景

13. 新约会剧情
* 观星：柠檬水摊触发对话后触发购买天文望远镜，安装望远镜和观星约会剧情，约会剧情会根据季节和随机值有细微差分，安装望远镜后新增阁楼文本描述，柠檬水摊对话更新，孤儿院大厅随机事件等细节改动。
* 海边游泳：柠檬水摊触发对话后可在罗宾房间向罗宾提议去海边游泳，但只有在指定时间才会触发约会选项，约会前可与罗宾互送泳衣（可借此开启异装线），约会可持续一整个白天，约会结束后可触发本mod第一场遭遇战。

14. 自愿遭遇战补充：满足一定条件后，半夜可以主动爬罗宾床，柠檬水摊/巧克力摊和直播时可以选择"爬到摊位/桌子底下"。

15. 0.5.0版本微适配：消灭模组报错，修改模组内的阴晴雨雪判定，热巧克力摊新增防雨功能（新版冬天终于可以下雨了），删除新版本的罗宾存款上限。

16. 共同反抗贝利
* 获取「同舟共济」特质后，每周可以选择一次「说服罗宾一起反抗贝利」，罗宾同意（需要自信91，固定周收入超过4000）后进入反抗线。
* 反抗线每周在孤儿院大厅触发一次专属租金战斗，规则详情见"17.补充：反抗线常规遭遇战机制说明"。
* 战斗胜利后，获取成就"联合作战"，「被罗宾守护」特质将切换为「同舟共济」；战斗失败后，结束反抗线，「同舟共济」特质将切换为「被罗宾守护」。
* （未完待续）

17. 附录：反抗线常规遭遇战机制说明
- 初始条件：贝利血量800，打手数量4人，罗宾血量在200-400之间(自信是倍率)。
- 分配罗宾受到的攻击：（1） pc有行动力的情况下，打手数量三或四时，随机两名打手打罗宾; 打手数量一或二时，随机一名打手打罗宾；打手数量为零时，贝利轮流打pc和罗宾。（2）pc无行动力的情况下，所有人都来攻击罗宾，反之亦然。
- 罗宾的固定作战策略：除第一回合使用喷雾加挑衅以外，其余回合都会挑选当前血量最小，且正在攻击自己的敌人进行攻击。
- 罗宾的攻击力：除第一回合外，默认动作为双手击打+踢+挑衅，默认罗宾英语A*，体能为中等体型满体能，自信作为倍率。
所以每回合的攻击力范围是30 * 3-30 * 6（90-180）。
- 罗宾的血量： 默认罗宾科学 A*, 效果为疼痛值 * 0.6，基础血量200，是pc疼痛上限的两倍，敌人每回合双手击打。
故罗宾血量每回合扣 48 * 正在攻击罗宾的敌人数量，每击退一名敌人罗宾回血15*2=30。血量为0时，罗宾将无法行动。
- 罗宾的创伤：罗宾血量小于一半时，每回合创伤+1。罗宾血量小于20%时，每回合创伤+2。每击败一名敌人创伤-2。
创伤对战斗过程无影响。
- 遭遇战结束条件：敌人血量为零（胜利），或者pc和罗宾均失去行动能力（失败）。

18. 细节变动：购买望远镜图标和观星手持更新（挪用鹰塔图标），望远镜新增加叛逆事件，罗宾主动爬床之后会在意pc的进度，将新增成就的位置从"常规"调整到"社交"。

## 未实现的功能构想

一、反抗线构想（已部分实装）

1. 获取「同舟共济」特质后，每周pc可以选择一次「说服罗宾一起反抗贝利」，罗宾同意（需要自信91，固定周收入超过4000）后进入反抗线。
2. 反抗线会有专属的租金战斗，根据罗宾自信算攻击力，失败后罗宾仍然有机会交钱不会受惩罚，同时如此时罗宾收入足够且pc未拿到「被罗宾守护」特质，将自动获取特质。（但会导致反抗线结束）
3. 专属租金战斗难度暂时设计为贝利血量翻倍，打手数量翻倍，但罗宾有中等体型满体能pc的攻击力，以及自信作为倍率，且根据条件有可能使用喷雾。
4. 与罗宾一起打赢一次贝利后可获得铜成就"联合作战"（成就名和等级可调），且大幅增加孤儿院的叛逆和希望。
5. 连续反抗成功三次以后，如果罗宾和pc之前至少各帮助过一名孤儿且收到过对方回报，且孤儿院氛围达到"革命性的"，将进入剧情杀。
剧情杀结束后，所有受过帮助的孤儿都会出场一起作战，且默认能打赢（只会有剧情说明），之后获得金成就"万众一心"。（成就名可调）
6. 反抗线副产品：惠特尼食堂那啥时，自信高于91的罗宾会和pc一起上。（这里就不加强惠特尼了，只是剧情上的爽点而已）

二、荒原观星

1. 与罗宾一起观星两次后，第三次开始触发对话"因城市光污染严重，想要去荒原观星"，罗宾自信大于91，且已经是沼泽小队的成员的情况下才会答应，否则每次约会时保留选项。
2. 荒原观星路线为森林湖——瀑布——小溪——沼泽——荒原，到达荒原即可触发观星剧情和成就（无需探索荒原）
3. 成就暂定为银成就，名为"counting stars"

三、其他补充事件

1. 在码头救援替换罗宾后，新增各种重逢场景（这是作者自己的心愿）
2. 野餐时判断罗宾是否处于哺乳期（随便加个规则），如果是的话就可以喝奶
3. 获取特质「被罗宾守护」后，每天早上可以被罗宾叫醒（daily.daddyWake)
4. 去咖啡馆买酒后晚上回家可以和罗宾一起喝酒，罗宾醉酒后可以「顺从」，「反压」或者「哄睡」
5. 罗宾与pc一起直播（内容待构想）
6. 有神圣转化时pc可带罗宾从天台等处滑翔（ps: 其实用罗宾专属知更鸟转化可能更合适，这个之后再说）